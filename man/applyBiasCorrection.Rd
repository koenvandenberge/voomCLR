% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/applyBiasCorrection.R
\name{applyBiasCorrection}
\alias{applyBiasCorrection}
\title{Apply bias correction to estimated regression coefficients.}
\usage{
applyBiasCorrection(fit)
}
\arguments{
\item{fit}{The result of calling \code{lmFit} or \code{contrasts.fit},
before running \code{eBayes}.}
}
\description{
Apply bias correction to estimated regression coefficients.
}
\examples{
library(limma)
set.seed(495212344)
n <- 40 # sample size
P <- 10 # number of cell types
mu0 <- rnbinom(n = P, size = 1 / 2, mu = 400)
mu0 # absolute counts in group 0
beta <- rlnorm(n = P, meanlog = 0, sdlog = 2) * # these are log-fold-changes
  rbinom(n = P, size = 1, prob = .15) *
  sample(c(-1, 1), size = P, replace = TRUE) # fold change on log scale
mu1 <- exp(beta) * mu0 # because we want log(mu2/mu1) = beta
relAbundances <- data.frame(
  g0 = mu0 / sum(mu0),
  g1 = mu1 / sum(mu1)
) # relative abundance of absolute count
# relative abundance information (observed data in typical experiment)
Y0 <- rmultinom(n = 10, size = 1e4, prob = relAbundances$g0)
Y1 <- rmultinom(n = 10, size = 1e4, prob = relAbundances$g1)
Y <- cbind(Y0, Y1)
rownames(Y) <- paste0("celltype", 1:10)
colnames(Y) <- paste0("sample", 1:20)
group <- factor(rep(0:1, each = 10))
design <- model.matrix(~group)
v <- voomCLR(
  counts = Y,
  design = design,
  lib.size = NULL,
  plot = TRUE
)
fit <- lmFit(v, design)
fit <- applyBiasCorrection(fit)
fit <- eBayes(fit)
}
